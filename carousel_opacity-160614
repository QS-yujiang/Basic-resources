<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<title>轮播Demo</title>
	<style>
		* {
			margin: 0;
			padding: 0;
		}
		ul, li {
			list-style: none;
		}
		a {
			color: inherit;
			text-decoration: none;
		}

			.carousel,
			.img-cover,
			.img-cover li,
			.img-cover li a,
			#img-bg,
			#img-bg a {
				width: 100%;
				height: 460px;
			}
				.carousel,
				.img-cover {
					position: relative;
				} 
					.img-cover li,
					.btn-cover,
					#img-bg {
						position: absolute;
						left: 0;
					}
					.img-cover li {
						z-index: 1;
						filter: alpha(opacity=0);
						opacity: 0;
					}
					.img-cover .cur {
						z-index: 6;
						filter: alpha(opacity=100);
						opacity: 1;
					}
						#img-bg a,
						.img-cover li a {
							display: block;
						}
						.img-cover ._ig1_ a {
							background-color: #233b72;
						}
						.img-cover ._ig2_ a {
							background-color: #519246;
						}
						.img-cover ._ig3_ a {
							background-color: #b7ae1c;
						}

				.btn-cover {
					bottom: 18px;
					z-index: 9;
					width: 100%;
					text-align: center;
					font-size: 0;
				}
					.btn-cover li {
						display: inline-block;
						*display: inline;
						*zoom: 1;
						width: 13px;
						height: 13px;
						margin: 0 3px;
						border: 1px solid #ddd;
						cursor: pointer;
					}
					.btn-cover li.on {
						background-color: #ddd;
					} 
	</style>
</head>
<body>
	<div class="carousel" id="carousel">
		<ul class="img-cover">
			<li class="_ig1_ cur"><a href="#" target="_blank"></a></li>
			<li class="_ig2_"><a href="#" target="_blank"></a></li>
			<li class="_ig3_"><a href="#" target="_blank"></a></li>
		</ul>
		<ul class="btn-cover">
		</ul>
	</div>
	<script>
		function addOnLoad(func){

			var oldonload = window.onload;

			if(typeof window.onload != "function"){

				window.onload = func;

			} else {

				window.onload = function(){

					oldonload();

					func();

				};
			}
		}

		function getCln(node, cln){

			if(node.getElementsByClassName){

				return node.getElementsByClassName(cln);

			} else {

				var results = [];

				var els = node.getElementsByTagName("*");

				for(var i = 0, len = els.length; i < len; i++){

					if(els[i].className.indexOf(cln) > -1){

						results[results.length] = els[i];

					}

				}

				return results;

			}
		}

		function getSt(obj, stl){

			return window.getComputedStyle ? window.getComputedStyle(obj, null)[stl] : obj.currentStyle[stl];

		}


		function Zarousel(p){

			this.o = p.op;

			this.i = p.oi;

			this.b = p.ob;

			this.loop = null;

			this.timer = null;

			this.idx = 0;


			this.init();

		}

		Zarousel.prototype = {

			constructor: Zarousel,

			init: function(){

				this.abg();

				this.rbn();

				this.cbn();

				//循环播放
				var self = this;

				this.loop = setInterval(function(){

					self.auto();

				}, 3000);

				this.o.onmouseover = function(){

					clearInterval(self.loop);

				};

				this.o.onmouseout = function(){

					self.loop = setInterval(function(){

						self.auto();

					}, 3000);

				};

			},

			abg: function(){

				var d = document.createElement("div");

					if(d.setAttribute) {

						d.setAttribute("id", "img-bg");

						d.setAttribute("class", "_ig1_");

					} else {

						d.id = "img-bg";

						d.className = "_ig1_";

					}

				var a = document.createElement("a");

					if(a.setAttribute){

						a.setAttribute("href", "javascript:;");

					} else {

						a.href = "javascript:;";

					}

				d.appendChild(a);

				this.i.appendChild(d);

			},

			cbg: function(x){

				var bg = document.getElementById("img-bg");

					bg.className = "_ig" + (x + 1) + "_";

			},

			rbn: function(){
				//获取图片单元
				this.il = this.i.getElementsByTagName("li");

				var len = this.il.length;

				for(var i = 0; i < len; i++){

					var li = document.createElement("li");

					this.b.appendChild(li);

				}
				//获取按钮单元
				this.ib = this.b.getElementsByTagName("li");

				this.ib[0].className = "on";

			},

			cbn: function(){

				var self = this;

				var b = this.ib;

				for(var i = 0, len = b.length; i < len; i++){

					b[i].index = i;

					b[i].onclick = function(){

						self.apr(this.index);

						self.idx = this.index;

					};

				}

			},

			cevt: function(x){

				var l = this.il;

				var b = this.ib;

				for(var i = 0, len = l.length; i < len; i++){

					var ln = l[i].className;

					if(ln.indexOf(" cur") > -1){

						l[i].className = ln.replace(" cur", "");

					}

					if(l[i].getAttribute("style")){

						l[i].removeAttribute("style");

					}

					if(b[i].getAttribute("class")){

						b[i].removeAttribute("class");

					}

				}

				b[x].className = "on";

			},

			apr: function(x){
				//完成透明度由0到1的变化
				var self = this;
				
				var o = this.il[x];

				var tol = 100;

				this.cevt(x);

				if(this.timer) clearInterval(this.timer);

				this.timer = setInterval(function(){
					//当前透明度的值
					var opc = getSt(o, "opacity") * 100;

					var speed = (tol - opc) / 5;

						speed = Math.ceil(speed);

					if(opc === tol){

						clearInterval(self.timer);

						o.className += " cur";

						self.cbg(x);

					} else {

						o.style.filter = "alpha(opacity=" + (opc + speed) + ")";

						o.style.opacity = (opc + speed) / 100;

					}

				}, 10);

			},

			auto: function(){

				var len = this.il.length;

				if(this.idx >= len - 1){

					this.idx = 0;

				} else {

					this.idx ++;

				}

				this.apr(this.idx);

			}

		};

		function zpar(){

			var o = document.getElementById("carousel");

			var par = {

				op : o,

				oi : getCln(o, "img-cover")[0],

				ob : getCln(o, "btn-cover")[0]

			};

			return par;

		}

		function pageEvts(){

			var pr = zpar();

			new Zarousel(pr);

		}

		addOnLoad(pageEvts);
	</script>
</body>
</html> 
